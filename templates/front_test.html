<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
  <title>ながら測定器</title>
  <link rel='stylesheet' href='static/css/style.css'>
  <script type="text/javascript" src="static/js/menu.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
</head>
<body>
  <div class="main">
    <div class="contents">
        <canvas id="ChartDemo" width='1231' height='150'></canvas>
        <script>
        window.onload = function() {
          // Pythonからのデータを受け取る
          var caloriePerFift = {{ calorieperfift|tojson }}
          // データをグラフ用に整形
          var times = []
          var tCalories = []
          for(k in caloriePerFift){
            times.push(k)
            tCalories.push(caloriePerFift[k])
          }

          var ctx = document.getElementById("ChartDemo").getContext('2d');
          var ChartDemo = new Chart(ctx, {
          type: 'line',
          data: {
            labels: times,
            datasets: [
            {
               label: "消費カロリー",
               borderColor: 'rgb(255, 0, 0)',
               data: tCalories,
            }
            ]
         },
         options: {
            responsive: true,
            scales: {
              yAxes: [
                {
                  ticks: {
                    beginAtZero: true,
                    min: 0,
                    max:350
                  }
                }
              ]
            }
         }
      });

        ChartDemo.render();
      }
        </script>

        <canvas id="ChartDemo2" width='1231' height='150'></canvas>
        <script>
          // Pythonからのデータを受け取る
          var caloriePerDay = {{ calorieperday|tojson }}
          // データをグラフ用に整形
          var dates = []
          var dCalories = []
          for(k in caloriePerDay){
            dates.push(k)
            dCalories.push(caloriePerDay[k])
          }
          var maxData = (new Array(dates.length)).fill(4000)

          var ctx = document.getElementById("ChartDemo2").getContext('2d');
          var ChartDemo2 = new Chart(ctx, {
           type: 'line',
           data: {
             labels: dates,
              datasets: [
              {
                 label: "消費カロリー",
                 borderColor: 'rgb(255, 0, 0)',
                 data: dCalories,
              },

              {
                label: "目標消費カロリー",
                lineTension: 0,
                fill: false,
                borderColor: 'rgb(0, 0, 255)',
                data: maxData,
                borderDash:[5,5],
              }
              ]
           },
           options: {
              responsive: true,
              scales: {
                yAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                      min: 0,
                      max:450
                    }
                  }
                ]
              }
           }
        });
        </script>

        <table width=100%, border="1">
          <tr>
            <th width=35%><p>本日の消費カロリー</p></th>
            <th width=35%><p>残り消費カロリー</p></th>
            <th width=10%><p>選択運動強度</p></th>
            <th width=20%><p>所要時間</p></th>
          </tr>
          <tr>
            <td align="center"><p>{{currentCalorie}} [cal]</p></td>
            <td align="center"><p>{{restCalorie}} [cal]</p></td>
            <td align="center"><p>{{exerciseRank}}</p></td>
            <td align="center"><p>40秒 (固定)</p></td>
          </tr>
        </table>

        <a href="static/html/{{ movieNum }}.html">
          <div class='campaign'>
            <h1>運動を開始する</h1>
          </div>
        </a>
      </div>
  </body>
</html>
